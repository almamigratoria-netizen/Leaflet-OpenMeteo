import{Control as t,LatLng as e,Util as n}from"leaflet";export class OpenMeteo extends t{initialize(t){this.name=OpenMeteo,n.setOptions(this,{position:"bottomleft",title:"Open-Meteo"}),n.setOptions(this,t)}_control_template(){function t(t,e="",n=void 0){const a=document.createElement(t);return a.className=e,n?.appendChild(a),a}const e=t("div","leaflet-control-openmeteo"),n=t("h4","",e);this._titlediv=n,n.textContent=this.options.title;const a=t("div","",e),M=t("img","weatherIcon",a);this._img=M;const o=t("div","",e);let i=t("span","",o);i.textContent="T: ";let g=t("span","",o);g.textContent="{temp}",this._tspan=g;const s=t("div","",e);i=t("span","",s),i.textContent="H: ",g=t("span","",s),g.textContent="{RH}",this._hspan=g;const A=t("div","",e);return i=t("span","",A),i.textContent="{wind}",this._wspan=i,e}_tweakConfig(){if(this.options.center){let t=this.options.center;this.options.center=new e(t[0],[1])}this.options.wind_directions&&("default"==this.options.wind_directions.toLowerCase()?this.options.wdirs=["N","NE","E","SE","S","SW","W","NW"]:this.options.wdirs=this.option.wind_drections)}_debounce(t,e){let n;return function(...a){clearTimeout(n),n=setTimeout(()=>t.apply(this,a),e)}}onAdd(t){this._tweakConfig(),this._div=this._control_template();const e=this.refresh.bind(this),n=this._debounce(e,750);return window.setInterval(n,36e5),t.on("moveend",n,this),n(),this._div}async refresh_autoTitle(t){const e=this._map.getCenter();let n=`https://nominatim.openstreetmap.org/reverse?lat=${e.lat}&lon=${e.lng}`;n+="&zoom=10&format=jsonv2";try{const e=await fetch(n),a=await e.json();if(a.error)return void(t.textContent="Here be dragons");let M=a.address.city||a.address.municipality;M=M||a.address.state||a.address.country,M=M||"Open-Meteo",t.textContent=M}catch(t){console.warn(`${t.name}: ${t.message}(${n})`)}}async refresh(){function t(t){return M[t]+o[t]}let e,n=this.options.center||this._map.getCenter(),a="https://api.open-meteo.com/v1/forecast?latitude=";a=a+n.lat+"&longitude="+n.lng,a+="&current=temperature_2m,relative_humidity_2m,",a+="wind_speed_10m,wind_direction_10m,precipitation,",a+="rain,showers,weather_code,cloud_cover,uv_index";try{const t=await fetch(a);if(e=await t.json(),!t.ok){throw new Error(`fetch(${t.statusText})`)}}catch(t){return void console.error(`Leaflet.OpenMeteo: ${t.name} ${t.message}`)}const M=e.current,o=e.current_units;this._tspan.textContent=t("temperature_2m"),this._hspan.textContent=t("relative_humidity_2m");let i=M.wind_direction_10m;this.options.wdirs&&(i=this.mapWindDirection(M.wind_direction_10m));let g=i+"@"+t("wind_speed_10m");this._wspan.textContent=g;const s="om-"+M.weather_code;this._img.classList=`weatherIcon ${s}`,this.options.autoTitle&&this.refresh_autoTitle(this._titlediv)}mapWindDirection(t){const e=this.options.wdirs.length,n=360/e;t=(t+n/2)%360;let a=Math.round(t/n)%e;return this.options.wdirs[a]}}export default OpenMeteo;!function(){try{const t=new CSSStyleSheet;t.replaceSync('\n.leaflet-control-openmeteo {\n  color:#eee;\n  background:#555;\n  padding:1em;\n  opacity:0.7;\n  width:200px;\n}\n.leaflet-control-openmeteo .weatherIcon {\n  float:left;\n  width:50px;\n  height:50px;\n  margin-right:10px;\n}\n.leaflet-control-openmeteo.weatherIcon img {\n  float:left;\n  max-width: 100% !important;\n  height: 100%;\n  width: 100%;\n  object-fit: fill;\n  stroke-width: 2px;\n}\n.leaflet-control-openmeteo h4 {\n  font-size: 1.5em;\n  text-align: center;\n  margin-block-start: 12px;\n  margin-block-end: 12px;\n}\n\n/* If the dataURL was smaller as base64, then base64\'d it.  Some are, some\n * are not.  Further reduction in size is probably possible.  CSS3 allows\n * path:, but I haven\'t figured that one out, so for now....\n */\n\n/* sunny */\n.om-0 {\n    background-image: url(\'data:image/svg+xml,%3C%3Fxml version%3D"1.0" %3F%3E%3Csvg viewBox%3D"0 0 24 24" xmlns%3D"http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg"%3E%3Cpath%20d%3D%22M12%2017.01c2.76%200%205.01-2.25%205.01-5.01S14.76%206.99%2012%206.99%206.99%209.24%206.99%2012s2.25%205.01%205.01%205.01M12%209c1.66%200%203.01%201.35%203.01%203.01s-1.35%203.01-3.01%203.01-3.01-1.35-3.01-3.01S10.34%209%2012%209m1%2010h-2v3h2zm0-17h-2v3h2zM2%2011h3v2H2zm17%200h3v2h-3zM4.22%2018.36l.71.71.71.71%201.06-1.06%201.06-1.06-.71-.71-.71-.71-1.06%201.06zM19.78%205.64l-.71-.71-.71-.71-1.06%201.06-1.06%201.06.71.71.71.71%201.06-1.06zm-12.02.7L6.7%205.28%205.64%204.22l-.71.71-.71.71L5.28%206.7l1.06%201.06.71-.71zm8.48%2011.32%201.06%201.06%201.06%201.06.71-.71.71-.71-1.06-1.06-1.06-1.06-.71.71z%22%2F%3E%3C%2Fsvg%3E\');\n}\n/* cloudy */\n.om-1, .om-2, .om-3 {\n  background-image: url(\'data:image/svg+xml,%3C%3Fxml version%3D"1.0" %3F%3E%3Csvg viewBox%3D"0 0 24 24" xmlns%3D"http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg"%3E%3Cpath stroke%3D"white" d%3D"M19.62 11.11C19.19 7.12 15.94 4 12 4 8.95 4 6.31 5.87 5.13 8.82 2.77 9.53 1 11.85 1 14.33 1 17.45 3.44 20 6.44 20h12.22c2.39 0 4.33-2.02 4.33-4.5 0-2.14-1.45-3.94-3.38-4.39ZM18.67 18H6.44C4.54 18 3 16.35 3 14.33c0-1.72 1.38-3.37 3.07-3.68l.58-.11.19-.56C7.64 7.53 9.62 6 12 6c3.12 0 5.67 2.69 5.67 6v1h1c1.29 0 2.33 1.12 2.33 2.5S19.95 18 18.67 18"%2F%3E%3C%2Fsvg%3E\');\n}\n/* fog */\n.om-45, .om-48 {\n  background-image: url(\'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGZpbGw9ImN1cnJlbnRDb2xvciIgdmlld0JveD0iMCAwIDE2IDE2Ij48cGF0aCBkPSJNMyAxMy41YS41LjUgMCAwIDEgLjUtLjVoOWEuNS41IDAgMCAxIDAgMWgtOWEuNS41IDAgMCAxLS41LS41bTAgMmEuNS41IDAgMCAxIC41LS41aDlhLjUuNSAwIDAgMSAwIDFoLTlhLjUuNSAwIDAgMS0uNS0uNW0xMC40MDUtOS40NzNhNS4wMDEgNS4wMDEgMCAwIDAtOS40OTktMS4wMDRBMy41IDMuNSAwIDEgMCAzLjUgMTJIMTNhMyAzIDAgMCAwIC40MDUtNS45NzNNOC41IDNhNCA0IDAgMCAxIDMuOTc2IDMuNTU1LjUuNSAwIDAgMCAuNS40NDVIMTNhMiAyIDAgMCAxIDAgNEgzLjVhMi41IDIuNSAwIDEgMSAuNjA1LTQuOTI2LjUuNSAwIDAgMCAuNTk2LS4zMjlBNCA0IDAgMCAxIDguNSAzIi8+PC9zdmc+Cg==\');\n}\n/* drizzle (light, moderate, and dense) */\n/* 56, 57 are freezing drizzle */\n.om-51, .om-53, .om-55, .om-56, .om-57 {\n  background-image: url(\'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGZpbGw9ImN1cnJlbnRDb2xvciIgdmlld0JveD0iMCAwIDE2IDE2Ij48cGF0aCBkPSJNNC4xNTggMTIuMDI1YS41LjUgMCAwIDEgLjMxNi42MzNsLS41IDEuNWEuNS41IDAgMCAxLS45NDgtLjMxNmwuNS0xLjVhLjUuNSAwIDAgMSAuNjMyLS4zMTdtMyAwYS41LjUgMCAwIDEgLjMxNi42MzNsLTEgM2EuNS41IDAgMCAxLS45NDgtLjMxNmwxLTNhLjUuNSAwIDAgMSAuNjMyLS4zMTdtMyAwYS41LjUgMCAwIDEgLjMxNi42MzNsLS41IDEuNWEuNS41IDAgMCAxLS45NDgtLjMxNmwuNS0xLjVhLjUuNSAwIDAgMSAuNjMyLS4zMTdtMyAwYS41LjUgMCAwIDEgLjMxNi42MzNsLTEgM2EuNS41IDAgMSAxLS45NDgtLjMxNmwxLTNhLjUuNSAwIDAgMSAuNjMyLS4zMTdtLjI0Ny02Ljk5OGE1LjAwMSA1LjAwMSAwIDAgMC05LjQ5OS0xLjAwNEEzLjUgMy41IDAgMSAwIDMuNSAxMUgxM2EzIDMgMCAwIDAgLjQwNS01Ljk3M004LjUgMmE0IDQgMCAwIDEgMy45NzYgMy41NTUuNS41IDAgMCAwIC41LjQ0NUgxM2EyIDIgMCAwIDEgMCA0SDMuNWEyLjUgMi41IDAgMSAxIC42MDUtNC45MjYuNS41IDAgMCAwIC41OTYtLjMyOUE0IDQgMCAwIDEgOC41IDIiLz48L3N2Zz4=\');\n}\n/* Steady Rain (Slight, moderate, heavy) */\n.om-61, .om-63, .om-65 {\n  background-image: url(\'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGZpbGw9ImN1cnJlbnRDb2xvciIgdmlld0JveD0iMCAwIDE2IDE2Ij48cGF0aCBkPSJNNC4xNTggMTIuMDI1YS41LjUgMCAwIDEgLjMxNi42MzNsLS41IDEuNWEuNS41IDAgMCAxLS45NDgtLjMxNmwuNS0xLjVhLjUuNSAwIDAgMSAuNjMyLS4zMTdtMyAwYS41LjUgMCAwIDEgLjMxNi42MzNsLTEgM2EuNS41IDAgMCAxLS45NDgtLjMxNmwxLTNhLjUuNSAwIDAgMSAuNjMyLS4zMTdtMyAwYS41LjUgMCAwIDEgLjMxNi42MzNsLS41IDEuNWEuNS41IDAgMCAxLS45NDgtLjMxNmwuNS0xLjVhLjUuNSAwIDAgMSAuNjMyLS4zMTdtMyAwYS41LjUgMCAwIDEgLjMxNi42MzNsLTEgM2EuNS41IDAgMSAxLS45NDgtLjMxNmwxLTNhLjUuNSAwIDAgMSAuNjMyLS4zMTdtLjI0Ny02Ljk5OGE1LjAwMSA1LjAwMSAwIDAgMC05LjQ5OS0xLjAwNEEzLjUgMy41IDAgMSAwIDMuNSAxMUgxM2EzIDMgMCAwIDAgLjQwNS01Ljk3M004LjUgMmE0IDQgMCAwIDEgMy45NzYgMy41NTUuNS41IDAgMCAwIC41LjQ0NUgxM2EyIDIgMCAwIDEgMCA0SDMuNWEyLjUgMi41IDAgMSAxIC42MDUtNC45MjYuNS41IDAgMCAwIC41OTYtLjMyOUE0IDQgMCAwIDEgOC41IDIiLz48L3N2Zz4K\');\n}\n/* Freezing Rain */\n.om-66, .om-67 {\n  background-image: url(\'data:image/svg+xml,%3Csvg xmlns%3D"http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" viewBox%3D"0 0 16 16"%3E%3Cpath d%3D"M13.405 4.027a5.001 5.001 0 0 0-9.499-1.004A3.5 3.5 0 1 0 3.5 10H13a3 3 0 0 0 .405-5.973M8.5 1a4 4 0 0 1 3.976 3.555.5.5 0 0 0 .5.445H13a2 2 0 0 1 0 4H3.5a2.5 2.5 0 1 1 .605-4.926.5.5 0 0 0 .596-.329A4 4 0 0 1 8.5 1M2.375 13.5a.25.25 0 0 1 .25.25v.57l.501-.287a.25.25 0 0 1 .248.434l-.495.283.495.283a.25.25 0 0 1-.248.434l-.501-.286v.569a.25.25 0 1 1-.5 0v-.57l-.501.287a.25.25 0 0 1-.248-.434l.495-.283-.495-.283a.25.25 0 0 1 .248-.434l.501.286v-.569a.25.25 0 0 1 .25-.25m1.849-2.447a.5.5 0 0 1 .223.67l-.5 1a.5.5 0 1 1-.894-.447l.5-1a.5.5 0 0 1 .67-.223zM6.375 13.5a.25.25 0 0 1 .25.25v.57l.501-.287a.25.25 0 0 1 .248.434l-.495.283.495.283a.25.25 0 0 1-.248.434l-.501-.286v.569a.25.25 0 1 1-.5 0v-.57l-.501.287a.25.25 0 0 1-.248-.434l.495-.283-.495-.283a.25.25 0 0 1 .248-.434l.501.286v-.569a.25.25 0 0 1 .25-.25m1.849-2.447a.5.5 0 0 1 .223.67l-.5 1a.5.5 0 1 1-.894-.447l.5-1a.5.5 0 0 1 .67-.223zm2.151 2.447a.25.25 0 0 1 .25.25v.57l.501-.287a.25.25 0 0 1 .248.434l-.495.283.495.283a.25.25 0 0 1-.248.434l-.501-.286v.569a.25.25 0 1 1-.5 0v-.57l-.501.287a.25.25 0 0 1-.248-.434l.495-.283-.495-.283a.25.25 0 0 1 .248-.434l.501.286v-.569a.25.25 0 0 1 .25-.25m1.849-2.447a.5.5 0 0 1 .223.67l-.5 1a.5.5 0 1 1-.894-.447l.5-1a.5.5 0 0 1 .67-.223z"%2F%3E%3C%2Fsvg%3E\');\n}\n/* Snowfall (slight, moderate, heavy) */\n.om-71, .om-73, .om-75, .om-77, .om-85, .om-86 {\n  background-image: url(\'data:image/svg+xml,%3Csvg xmlns%3D"http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" fill%3D"currentColor" viewBox%3D"0 0 16 16"%3E%3Cpath d%3D"M8 16a.5.5 0 0 1-.5-.5v-1.293l-.646.647a.5.5 0 0 1-.707-.708L7.5 12.793V8.866l-3.4 1.963-.496 1.85a.5.5 0 1 1-.966-.26l.237-.882-1.12.646a.5.5 0 0 1-.5-.866l1.12-.646-.884-.237a.5.5 0 1 1 .26-.966l1.848.495L7 8 3.6 6.037l-1.85.495a.5.5 0 0 1-.258-.966l.883-.237-1.12-.646a.5.5 0 1 1 .5-.866l1.12.646-.237-.883a.5.5 0 1 1 .966-.258l.495 1.849L7.5 7.134V3.207L6.147 1.854a.5.5 0 1 1 .707-.708l.646.647V.5a.5.5 0 1 1 1 0v1.293l.647-.647a.5.5 0 1 1 .707.708L8.5 3.207v3.927l3.4-1.963.496-1.85a.5.5 0 1 1 .966.26l-.236.882 1.12-.646a.5.5 0 0 1 .5.866l-1.12.646.883.237a.5.5 0 1 1-.26.966l-1.848-.495L9 8l3.4 1.963 1.849-.495a.5.5 0 0 1 .259.966l-.883.237 1.12.646a.5.5 0 0 1-.5.866l-1.12-.646.236.883a.5.5 0 1 1-.966.258l-.495-1.849-3.4-1.963v3.927l1.353 1.353a.5.5 0 0 1-.707.708l-.647-.647V15.5a.5.5 0 0 1-.5.5z"%2F%3E%3C%2Fsvg%3E\');\n}\n/* Rain showers (Slight, moderate, violent) */\n.om-80, .om-81, .om-82 {\n  background-image: url(\'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxNiAxNiI+PHBhdGggZD0iTTQuMTc2IDExLjAzMmEuNS41IDAgMCAxIC4yOTIuNjQzbC0xLjUgNGEuNS41IDAgMSAxLS45MzYtLjM1bDEuNS00YS41LjUgMCAwIDEgLjY0NC0uMjkzbTMgMGEuNS41IDAgMCAxIC4yOTIuNjQzbC0xLjUgNGEuNS41IDAgMSAxLS45MzYtLjM1bDEuNS00YS41LjUgMCAwIDEgLjY0NC0uMjkzbTMgMGEuNS41IDAgMCAxIC4yOTIuNjQzbC0xLjUgNGEuNS41IDAgMSAxLS45MzYtLjM1bDEuNS00YS41LjUgMCAwIDEgLjY0NC0uMjkzbTMgMGEuNS41IDAgMCAxIC4yOTIuNjQzbC0xLjUgNGEuNS41IDAgMCAxLS45MzYtLjM1bDEuNS00YS41LjUgMCAwIDEgLjY0NC0uMjkzbS4yMjktNy4wMDVhNS4wMDEgNS4wMDEgMCAwIDAtOS40OTktMS4wMDRBMy41IDMuNSAwIDEgMCAzLjUgMTBIMTNhMyAzIDAgMCAwIC40MDUtNS45NzNNOC41IDFhNCA0IDAgMCAxIDMuOTc2IDMuNTU1LjUuNSAwIDAgMCAuNS40NDVIMTNhMiAyIDAgMCAxIDAgNEgzLjVhMi41IDIuNSAwIDEgMSAuNjA1LTQuOTI2LjUuNSAwIDAgMCAuNTk2LS4zMjlBNCA0IDAgMCAxIDguNSAxIi8+PC9zdmc+Cg==\');\n}\n/* Thunderstorm */\n.om-95, .om-96, .om-99 {\n  background-image: url(\'data:image/svg+xml,%3Csvg xmlns%3D"http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" viewBox%3D"0 0 16 16"%3E%3Cpath d%3D"M2.658 11.026a.5.5 0 0 1 .316.632l-.5 1.5a.5.5 0 1 1-.948-.316l.5-1.5a.5.5 0 0 1 .632-.316m9.5 0a.5.5 0 0 1 .316.632l-.5 1.5a.5.5 0 1 1-.948-.316l.5-1.5a.5.5 0 0 1 .632-.316m-7.5 1.5a.5.5 0 0 1 .316.632l-.5 1.5a.5.5 0 1 1-.948-.316l.5-1.5a.5.5 0 0 1 .632-.316m9.5 0a.5.5 0 0 1 .316.632l-.5 1.5a.5.5 0 1 1-.948-.316l.5-1.5a.5.5 0 0 1 .632-.316m-.753-8.499a5.001 5.001 0 0 0-9.499-1.004A3.5 3.5 0 1 0 3.5 10H13a3 3 0 0 0 .405-5.973M8.5 1a4 4 0 0 1 3.976 3.555.5.5 0 0 0 .5.445H13a2 2 0 0 1 0 4H3.5a2.5 2.5 0 1 1 .605-4.926.5.5 0 0 0 .596-.329A4 4 0 0 1 8.5 1M7.053 11.276A.5.5 0 0 1 7.5 11h1a.5.5 0 0 1 .474.658l-.28.842H9.5a.5.5 0 0 1 .39.812l-2 2.5a.5.5 0 0 1-.875-.433L7.36 14H6.5a.5.5 0 0 1-.447-.724z"%2F%3E%3C%2Fsvg%3E\');\n}\n'),document.adoptedStyleSheets.push(t)}catch(t){console.warn("You should replace your broken browser",t.message)}}();